{% load static %}
{% load i18n %}
{% load base %}
<!DOCTYPE html>
<html>
    <head>
        <title>{% block title %}{% endblock %}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="{% static 'core/base.css' %}" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@300;400;700&display=swap" rel="stylesheet">
        <link href="{% static 'fontawesomefree/css/fontawesome.css' %}" rel="stylesheet" type="text/css">
        <link href="{% static 'fontawesomefree/css/solid.css' %}" rel="stylesheet" type="text/css">
        {% if START_BEFORE or END_BEFORE %}
          <script type="module">
            import newCalculateTime from "{% static 'core/countdown.js' %}"

            const calculateTime = newCalculateTime(
              {{ START.timestamp }} * 1000,
              {{ END.timestamp }} * 1000,
	      "{% translate 'starts in' %}",
	      "{% translate '__startsPost' %}",
	      "{% translate '__endsPre' %}",
	      "{% translate 'remaining' %}",
              "{% translate 'scavenger hunt ended!' %}",
            )

            calculateTime()

            setInterval(calculateTime, 1000)
          </script>
        {% endif %}
        {% block head_end %}{% endblock %}
    </head>
    <body>
        <!-- GENDO START CommonHeader -->

<div id="common-header">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New&display=swap');
    #common-nav {
      background: #073763;
    }
    #common-nav-inner {
      margin: auto;
      max-width: 900px;
      font-size: 1rem;
      font-family: 'Zen Kaku Gothic New', sans-serif;
      font-weight: 400;
      color: #d0d0d0;
      padding: 4px;
    }
    #common-nav-inner a {
      color: #d0d0d0;
      text-decoration: none;
      padding-right: 10px;
    }
    #common-nav-inner a:hover {
      text-decoration: underline;
    }
    #common-nav-inner .this {
      color: #adadad;
    }
  </style>
  <nav id="common-nav">
    <div id="common-nav-inner">
      <a href="https://maclyonsden.com" style="color: #fff;">
        <img src="https://maclyonsden.com/static/core/img/themes/logos/dark-transparent.png" style="height: 27px; display: inline; vertical-align: middle;" alt="Metropolis logo" />
        Metropolis
      </a>
      
      
        <a href="https://doodle.maclyonsden.com">Doodles</a>
      
      <span class="this">
        Scavenger Hunt (2022)
      </span>
    </div>
  </nav>
</div>
<!-- GENDO END CommonHeader -->
    <header>
      {% comment %} TODO: consider merging header and title {% endcomment %}
      {% if messages %}
      <ul class="messages">
          {% for message in messages %}
          <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
              {% if message.level == DEFAULT_MESSAGE_LEVELS.DEBUG %}
                Debug:
              {% elif message.level == DEFAULT_MESSAGE_LEVELS.INFO %}
                Info:
              {% elif message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
                Success:
              {% elif message.level == DEFAULT_MESSAGE_LEVELS.WARNING %}
                Warning:
              {% elif message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
                <img src="{% static 'core/animal_buta_shock.png' %}" class="imgicon" alt="error" />
                Error:
              {% endif %}
              {{ message }}
          </li>
          {% endfor %}
      </ul>
      {% endif %}
    </header>
    <div style="flex-grow: 1.8;"></div>
    <main>
      <h1>{% block header %}{% endblock %}</h1>
      {% block body %}{% endblock %}
    </main>
    <div style="flex-grow: 1;"></div>
    {% if START_BEFORE or END_BEFORE %}
      <nav id="countdown-header">
        <span id="countdown-text-pre"></span>
        <span id="countdown"></span>
        <span id="countdown-text-post"></span>
      </nav>
    {% endif %}
    {% comment %} NOTE: (below) workaround for fixed positon {% endcomment %}
    <div class="main-header" style="visibility: hidden;">
      <div class="identity">
        {% if request.user.in_team %}
          <span class="team-name">bodge</span>
        {% endif %}
        <span class="username">bodge</span>
      </div>
    </div>
    <nav id="main-header" class="main-header">
      <div class="identity">
        {% if request.user.in_team %}
          {% if not request.user.team.solo %}
            <span class="team-name">{{ request.user.team.name }}</span>
          {% else %}
            <span class="team-name">solo</span>
          {% endif %}
        {% endif %}
        <span class="username">{{ request.user.username }}</span>
      </div>
      {% comment %} TODO: fa-light {% endcomment %}
      <span class="actions">
        <a href="{% url 'index' %}">
          <i class="fa-solid fa-house" aria-hidden="true"></i>
          <span class="icon-alt">
            {% translate "Home" %}
          </span>
        </a>
        {% if request.user.is_staff %}
          <a href="/admin">
            <i class="fa-solid fa-hammer" aria-hidden="true"></i>
            <span class="icon-alt">
              {% translate "Admin" %}
            </span>
          </a>
        {% endif %}
        {% if request.user.is_authenticated %}
          <a href="{% url 'qr_current' %}" class="noicon">
            {% translate "current" %}
          </a>
          <a href="{% url 'account_logout' %}">
            <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i>
            <span class="icon-alt">
              {% translate "Logout" %}
            </span>
          </a>
        {% else %}
          <a href="{% url 'oauth_login' %}">
            <i class="fa-solid fa-right-to-bracket" aria-hidden="true"></i>
            <span class="icon-alt">
              {% translate "Login" %}
            </span>
          </a>
        {% endif %}
      </span>
    </nav>
  </body>
</html>
